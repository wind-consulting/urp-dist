"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[353],{42618:(W,R,g)=>{g.d(R,{U:()=>o});var u=g(65938),n=g(94650),w=g(81208);class o{constructor(_,f){this.data=_,this.dialogRef=f,this.imageChangedEvent="",this.croppedImage="",this.imageChangedEvent=_.element}ngOnInit(){}imageCropped(_){this.croppedImage=_.base64}returnData(){this.dialogRef.close(this.croppedImage)}}o.\u0275fac=function(_){return new(_||o)(n.Y36(u.WI),n.Y36(u.so))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-crap-image"]],decls:14,vars:3,consts:[["mat-dialog-content",""],[1,"w-64"],[1,"flex","justify-center"],["src","assets/imgs/ajout-pencil.svg",2,"width","45px","height","45px"],[1,"text-black","dark:text-white","font-bold"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","imageCropped"],["mat-dialog-actions","",1,"flex","justify-center","mt-2"],["type","submit",1,"button-yellow",3,"click"]],template:function(_,f){1&_&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2),n._UZ(3,"img",3),n.qZA(),n.TgZ(4,"div",2)(5,"label",4),n._uU(6,"Recadrer votre nouvelle photo"),n.qZA()(),n._UZ(7,"br"),n.TgZ(8,"div",2)(9,"div",1)(10,"image-cropper",5),n.NdJ("imageCropped",function(v){return f.imageCropped(v)}),n.qZA()()(),n.TgZ(11,"div",6)(12,"button",7),n.NdJ("click",function(){return f.returnData()}),n._uU(13,"Valider"),n.qZA()()()()),2&_&&(n.xp6(10),n.Q6J("imageChangedEvent",f.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",1))},dependencies:[u.xY,u.H8,w.ap]})},44e3:(W,R,g)=>{g.d(R,{m:()=>e});var u=g(65938),n=g(30671),w=g(75476),o=g(94650),y=g(48768),_=g(7401),f=g(23245),x=g(25993),v=g(90455),O=g(98739);function C(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Nom "),o.qZA())}function Z(t,i){if(1&t&&(o.TgZ(0,"td",25),o._uU(1),o.qZA()),2&t){const a=i.$implicit;o.xp6(1),o.hij(" ",a.collaborator.firstname+" "+a.collaborator.lastname," ")}}function Q(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Type de contract "),o.qZA())}function L(t,i){if(1&t&&(o.TgZ(0,"td",25),o._uU(1),o.qZA()),2&t){const a=i.$implicit;o.xp6(1),o.hij(" ",a.contractType.description," ")}}function Y(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Dur\xe9e du contract "),o.qZA())}function U(t,i){if(1&t&&(o.TgZ(0,"td",25),o._uU(1),o.qZA()),2&t){const a=i.$implicit;o.xp6(1),o.hij(" ",a.duration+" "+a.unit_duration," ")}}function F(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Salaire "),o.qZA())}function P(t,i){if(1&t&&(o.TgZ(0,"td",25),o._uU(1),o.qZA()),2&t){const a=i.$implicit;o.xp6(1),o.hij(" ",a.salary.baseSalary," ")}}function K(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Titre "),o.qZA())}function N(t,i){if(1&t&&(o.TgZ(0,"td",25),o._uU(1),o.qZA()),2&t){const a=i.$implicit;o.xp6(1),o.hij(" ",a.title," ")}}function V(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Projet de test "),o.qZA())}function G(t,i){if(1&t&&(o.TgZ(0,"td",25),o._uU(1),o.qZA()),2&t){const a=i.$implicit;o.xp6(1),o.Oqu(a.trialPeriod.duation+" "+a.trialPeriod.unit)}}function X(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Status "),o.qZA())}function j(t,i){if(1&t){const a=o.EpF();o.TgZ(0,"td",25)(1,"mat-slide-toggle",26),o.NdJ("change",function(s){const l=o.CHM(a).$implicit,m=o.oxw();return o.KtG(m.setContractStatus(l,s))}),o.qZA()()}if(2&t){const a=i.$implicit,r=o.oxw();o.xp6(1),o.Q6J("checked",r.isChecked(a))}}function J(t,i){1&t&&(o.TgZ(0,"th",24),o._uU(1," Document de contract "),o.qZA())}function q(t,i){if(1&t){const a=o.EpF();o.TgZ(0,"td",25)(1,"img",27),o.NdJ("click",function(){const h=o.CHM(a).$implicit,l=o.oxw();return o.KtG(l.PreviewContract(h))}),o.qZA()()}}function et(t,i){1&t&&o._UZ(0,"tr",28)}function c(t,i){1&t&&o._UZ(0,"tr",29)}const p=function(){return[5,10,20]};class e{constructor(i,a,r,s,h,l){this.data=i,this.toast=a,this._fuseConfirmationService=r,this.docgenService=s,this.dialog=h,this.contractService=l,this.contractByCollaborator=[],this.displayedColumnsContract=["nom","type_de_contract","duree_du_contract","salaire","titre","projet_de_test","status","document_de_contract"],this.configValid={title:"Mise a jour des contracts",message:'Voulez-vous activer ce contract ?<br> <span class="font-medium">Cette action peut \xeatre annul\xe9e !</span>',icon:{show:!0,name:"heroicons_outline:lightning-bolt",color:"warning"},actions:{confirm:{show:!0,label:"Activer",color:"warn"},cancel:{show:!0,label:"Annuler"}},dismissible:!0}}ngOnInit(){null!==this.data.contract&&(this.contractByCollaborator=this.data.contract,this.dataSourceContracts=new n.by(this.data.contract))}setContractStatus(i,a){a.checked?this.contractService.getAllContractByCollaborator(i.collaborator.id).subscribe(r=>{0==r.filter(h=>"ACTIVE"==h.contractStatus).length?this.contractService.updateStatusContract(i).subscribe(h=>{this.toast.success({detail:"Statut contract a etait chang\xe9 avec success",duration:3500})}):this._fuseConfirmationService.open(this.configValid).afterClosed().subscribe({next:h=>{"confirmed"==h?this.contractService.updateStatusContract(i).subscribe(l=>{this.toast.success({detail:"Statut contract a etait chang\xe9 avec success",duration:3500}),this.contractService.getAllContractByCollaborator(i.collaborator.id).subscribe(m=>{this.dataSourceContracts=new n.by(m)})}):a.source.checked=!a.source.checked}})}):(this.toast.info({detail:"Il faut \xeatre titulaire d'au moins un contrat actif.",duration:3500}),a.source.checked=!0)}isChecked(i){return"ACTIVE"==i.contractStatus}PreviewContract(i){this.docgenService.generatePdfFromHtml(i).subscribe(a=>{const r=new FileReader,s=new Blob([a],{type:"application/pdf"});r.readAsDataURL(s),r.onload=h=>{this.doccURL=h.target.result,this.dialog.open(w.x,{data:{doccUrl:this.doccURL},width:"100%"}).afterClosed().subscribe(m=>{})}})}}e.\u0275fac=function(i){return new(i||e)(o.Y36(u.WI),o.Y36(y.s),o.Y36(_.R),o.Y36(f.S),o.Y36(u.uw),o.Y36(x.U))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-check-contract"]],decls:40,vars:6,consts:[["mat-dialog-content",""],[1,"mt-0","mb-2","p-2"],[1,"flex","justify-center","mb-2"],["src","assets/imgs/edit.svg",2,"width","45px","height","45px"],[1,"flex","justify-center","mb-4"],[1,"text-black","dark:text-white"],[1,"container","mx-5","px-4"],[1,"tab","overflow-x-auto"],["mat-table","",1,"overflow-x-auto","w-full",3,"dataSource"],["matColumnDef","nom"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type_de_contract"],["matColumnDef","duree_du_contract"],["matColumnDef","salaire"],["matColumnDef","titre"],["matColumnDef","projet_de_test"],["matColumnDef","status"],["matColumnDef","document_de_contract"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",1,"overflow-x-auto","w-full",3,"pageSizeOptions"],["mat-dialog-actions","",1,"flex","justify-center","mb-2"],["type","button",1,"button-yellow",3,"mat-dialog-close"],["mat-header-cell",""],["mat-cell",""],[1,"lab",3,"checked","change"],["src","./assets/imgs/blocknote.svg",1,"image-svg","max-w-none","ml-[35%]",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,a){1&i&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2),o._UZ(3,"img",3),o.qZA(),o.TgZ(4,"div",4)(5,"label",5),o._uU(6,"Liste des contracts"),o.qZA()()(),o.TgZ(7,"div",6)(8,"div",7)(9,"table",8),o.ynx(10,9),o.YNc(11,C,2,0,"th",10),o.YNc(12,Z,2,1,"td",11),o.BQk(),o.ynx(13,12),o.YNc(14,Q,2,0,"th",10),o.YNc(15,L,2,1,"td",11),o.BQk(),o.ynx(16,13),o.YNc(17,Y,2,0,"th",10),o.YNc(18,U,2,1,"td",11),o.BQk(),o.ynx(19,14),o.YNc(20,F,2,0,"th",10),o.YNc(21,P,2,1,"td",11),o.BQk(),o.ynx(22,15),o.YNc(23,K,2,0,"th",10),o.YNc(24,N,2,1,"td",11),o.BQk(),o.ynx(25,16),o.YNc(26,V,2,0,"th",10),o.YNc(27,G,2,1,"td",11),o.BQk(),o.ynx(28,17),o.YNc(29,X,2,0,"th",10),o.YNc(30,j,2,1,"td",11),o.BQk(),o.ynx(31,18),o.YNc(32,J,2,0,"th",10),o.YNc(33,q,2,0,"td",11),o.BQk(),o.YNc(34,et,1,0,"tr",19),o.YNc(35,c,1,0,"tr",20),o.qZA(),o._UZ(36,"mat-paginator",21),o.qZA()(),o.TgZ(37,"div",22)(38,"button",23),o._uU(39,"Ok"),o.qZA()()()),2&i&&(o.xp6(9),o.Q6J("dataSource",a.dataSourceContracts),o.xp6(25),o.Q6J("matHeaderRowDef",a.displayedColumnsContract),o.xp6(1),o.Q6J("matRowDefColumns",a.displayedColumnsContract),o.xp6(1),o.Q6J("pageSizeOptions",o.DdM(5,p)),o.xp6(2),o.Q6J("mat-dialog-close",a.data))},dependencies:[v.Rr,u.ZT,u.xY,u.H8,O.NW,n.BZ,n.fO,n.as,n.w1,n.Dz,n.nj,n.ge,n.ev,n.XQ,n.Gk]})},75476:(W,R,g)=>{g.d(R,{x:()=>o});var u=g(65938),n=g(94650),w=g(11481);class o{constructor(_,f){this.data=_,this.sanitizer=f,this.trustedUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.data.doccUrl)}ngOnInit(){}}o.\u0275fac=function(_){return new(_||o)(n.Y36(u.WI),n.Y36(w.H7))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-preview-component"]],decls:2,vars:1,consts:[[1,"modal-body",2,"padding","0"],["type","application/pdf","width","100%","height","600px",3,"src"]],template:function(_,f){1&_&&(n.TgZ(0,"div",0),n._UZ(1,"embed",1),n.qZA()),2&_&&(n.xp6(1),n.Q6J("src",f.trustedUrl,n.uOi))}})},23245:(W,R,g)=>{g.d(R,{S:()=>_});var u=g(17414),n=g(70262),w=g(54004),o=g(94650),y=g(80529);class _{constructor(x){this.http=x,this.baseUrl="http://localhost:8300"}updateTemplate(x){return this.http.post(`${this.baseUrl}/template`,x)}generatePdfFromHtml(x){return this.http.post(`${this.baseUrl}/pdfFromHtml`,x,{responseType:"arraybuffer"}).pipe((0,u.V)(6e4),(0,n.K)((v,O)=>[]),(0,w.U)(v=>v))}generatePdfFromHtmlContent(x){return this.http.post(`${this.baseUrl}/pdfFromHtmlContent`,x,{responseType:"arraybuffer",headers:{enctype:"multipart/form-data;"}}).pipe((0,u.V)(6e4),(0,n.K)((v,O)=>[]),(0,w.U)(v=>v))}}_.\u0275fac=function(x){return new(x||_)(o.LFG(y.eN))},_.\u0275prov=o.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"})},81208:(W,R,g)=>{g.d(R,{QG:()=>q,ap:()=>J});var u=g(15861),n=g(94650),w=g(11481),o=g(36895);const y=["wrapper"],_=["sourceImage"];function f(c,p){if(1&c){const e=n.EpF();n.TgZ(0,"img",4,5),n.NdJ("load",function(){n.CHM(e);const i=n.oxw();return n.KtG(i.imageLoadedInView())}),n.qZA()}if(2&c){const e=n.oxw();n.Udp("visibility",e.imageVisible?"visible":"hidden")("transform",e.safeTransformStyle),n.Q6J("src",e.safeImgDataUrl,n.LSH)}}function x(c,p){if(1&c){const e=n.EpF();n.ynx(0),n.TgZ(1,"span",9),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"topleft"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"topleft"))}),n._UZ(2,"span",10),n.qZA(),n.TgZ(3,"span",11),n._UZ(4,"span",10),n.qZA(),n.TgZ(5,"span",12),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"topright"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"topright"))}),n._UZ(6,"span",10),n.qZA(),n.TgZ(7,"span",13),n._UZ(8,"span",10),n.qZA(),n.TgZ(9,"span",14),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"bottomright"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"bottomright"))}),n._UZ(10,"span",10),n.qZA(),n.TgZ(11,"span",15),n._UZ(12,"span",10),n.qZA(),n.TgZ(13,"span",16),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"bottomleft"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"bottomleft"))}),n._UZ(14,"span",10),n.qZA(),n.TgZ(15,"span",17),n._UZ(16,"span",10),n.qZA(),n.TgZ(17,"span",18),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"top"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"top"))}),n.qZA(),n.TgZ(18,"span",19),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"right"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"right"))}),n.qZA(),n.TgZ(19,"span",20),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"bottom"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"bottom"))}),n.qZA(),n.TgZ(20,"span",21),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"left"))})("touchstart",function(i){n.CHM(e);const a=n.oxw(2);return n.KtG(a.startMove(i,a.moveTypes.Resize,"left"))}),n.qZA(),n.BQk()}}function v(c,p){if(1&c){const e=n.EpF();n.TgZ(0,"div",6),n.NdJ("keydown",function(i){n.CHM(e);const a=n.oxw();return n.KtG(a.keyboardAccess(i))}),n.TgZ(1,"div",7),n.NdJ("mousedown",function(i){n.CHM(e);const a=n.oxw();return n.KtG(a.startMove(i,a.moveTypes.Move))})("touchstart",function(i){n.CHM(e);const a=n.oxw();return n.KtG(a.startMove(i,a.moveTypes.Move))}),n.qZA(),n.YNc(2,x,21,0,"ng-container",8),n.qZA()}if(2&c){const e=n.oxw();n.Udp("top",e.cropper.y1,"px")("left",e.cropper.x1,"px")("width",e.cropper.x2-e.cropper.x1,"px")("height",e.cropper.y2-e.cropper.y1,"px")("margin-left","center"===e.alignImage?e.marginLeft:null)("visibility",e.imageVisible?"visible":"hidden"),n.ekj("ngx-ic-round",e.roundCropper),n.xp6(2),n.Q6J("ngIf",!e.hideResizeSquares)}}class O{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(p){Object.keys(p).filter(e=>e in this).forEach(e=>this[e]=p[e]),this.validateOptions()}setOptionsFromChanges(p){Object.keys(p).filter(e=>e in this).forEach(e=>this[e]=p[e].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var C=(()=>{return(c=C||(C={})).Move="move",c.Resize="resize",c.Pinch="pinch",C;var c})();function U(c,p){return c/100*p}let F=(()=>{class c{crop(e,t,i,a){const r=this.getImagePosition(e,t,i,a),s=r.x2-r.x1,h=r.y2-r.y1,l=document.createElement("canvas");l.width=s,l.height=h;const m=l.getContext("2d");if(!m)return null;null!=a.backgroundColor&&(m.fillStyle=a.backgroundColor,m.fillRect(0,0,s,h));const d=(a.transform.scale||1)*(a.transform.flipH?-1:1),b=(a.transform.scale||1)*(a.transform.flipV?-1:1),A=t.transformed;m.setTransform(d,0,0,b,A.size.width/2,A.size.height/2),m.translate(-r.x1/d,-r.y1/b),m.rotate((a.transform.rotate||0)*Math.PI/180);const I=a.transform.translateH?U(a.transform.translateH,A.size.width):0,T=a.transform.translateV?U(a.transform.translateV,A.size.height):0;m.drawImage(A.image,I-A.size.width/2,T-A.size.height/2);const M={width:s,height:h,imagePosition:r,cropperPosition:{...i}};a.containWithinAspectRatio&&(M.offsetImagePosition=this.getOffsetImagePosition(e,t,i,a));const H=this.getResizeRatio(s,h,a);return 1!==H&&(M.width=Math.round(s*H),M.height=a.maintainAspectRatio?Math.round(M.width/a.aspectRatio):Math.round(h*H),function Y(c,p,e){const t=c.width,i=c.height,a=t/(p=Math.round(p)),r=i/(e=Math.round(e)),s=Math.ceil(a/2),h=Math.ceil(r/2),l=c.getContext("2d");if(l){const m=l.getImageData(0,0,t,i),d=l.createImageData(p,e),b=m.data,A=d.data;for(let I=0;I<e;I++)for(let T=0;T<p;T++){const M=4*(T+I*p),H=I*r;let S=0,D=0,it=0,at=0,nt=0,ot=0,rt=0;const ht=Math.floor(T*a),pt=Math.floor(I*r);let $=Math.ceil((T+1)*a),tt=Math.ceil((I+1)*r);$=Math.min($,t),tt=Math.min(tt,i);for(let B=pt;B<tt;B++){const st=Math.abs(H-B)/h,lt=T*a,gt=st*st;for(let k=ht;k<$;k++){const ct=Math.abs(lt-k)/s,E=Math.sqrt(gt+ct*ct);if(E>=1)continue;S=2*E*E*E-3*E*E+1;const z=4*(k+B*t);rt+=S*b[z+3],it+=S,b[z+3]<255&&(S=S*b[z+3]/250),at+=S*b[z],nt+=S*b[z+1],ot+=S*b[z+2],D+=S}}A[M]=at/D,A[M+1]=nt/D,A[M+2]=ot/D,A[M+3]=rt/it}c.width=p,c.height=e,l.putImageData(d,0,0)}}(l,M.width,M.height)),M.base64=l.toDataURL("image/"+a.format,this.getQuality(a)),M}getImagePosition(e,t,i,a){const s=t.transformed.size.width/e.nativeElement.offsetWidth,h={x1:Math.round(i.x1*s),y1:Math.round(i.y1*s),x2:Math.round(i.x2*s),y2:Math.round(i.y2*s)};return a.containWithinAspectRatio||(h.x1=Math.max(h.x1,0),h.y1=Math.max(h.y1,0),h.x2=Math.min(h.x2,t.transformed.size.width),h.y2=Math.min(h.y2,t.transformed.size.height)),h}getOffsetImagePosition(e,t,i,a){const h=t.transformed.size.width/e.nativeElement.offsetWidth;let l,m;(a.canvasRotation+t.exifTransform.rotate)%2?(l=(t.transformed.size.width-t.original.size.height)/2,m=(t.transformed.size.height-t.original.size.width)/2):(l=(t.transformed.size.width-t.original.size.width)/2,m=(t.transformed.size.height-t.original.size.height)/2);const d={x1:Math.round(i.x1*h)-l,y1:Math.round(i.y1*h)-m,x2:Math.round(i.x2*h)-l,y2:Math.round(i.y2*h)-m};return a.containWithinAspectRatio||(d.x1=Math.max(d.x1,0),d.y1=Math.max(d.y1,0),d.x2=Math.min(d.x2,t.transformed.size.width),d.y2=Math.min(d.y2,t.transformed.size.height)),d}getResizeRatio(e,t,i){const a=i.resizeToWidth/e,r=i.resizeToHeight/t,s=new Array;i.resizeToWidth>0&&s.push(a),i.resizeToHeight>0&&s.push(r);const h=0===s.length?1:Math.min(...s);return h>1&&!i.onlyScaleDown?h:Math.min(h,1)}getQuality(e){return Math.min(1,Math.max(0,e.imageQuality/100))}}return c.\u0275fac=function(e){return new(e||c)},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),P=(()=>{class c{resetCropperPosition(e,t,i){if(!e?.nativeElement)return;const a=e.nativeElement;if(i.cropperStaticHeight&&i.cropperStaticWidth)t.x1=0,t.x2=a.offsetWidth>i.cropperStaticWidth?i.cropperStaticWidth:a.offsetWidth,t.y1=0,t.y2=a.offsetHeight>i.cropperStaticHeight?i.cropperStaticHeight:a.offsetHeight;else{const r=Math.min(i.cropperScaledMaxWidth,a.offsetWidth),s=Math.min(i.cropperScaledMaxHeight,a.offsetHeight);if(i.maintainAspectRatio)if(a.offsetWidth/i.aspectRatio<a.offsetHeight){t.x1=0,t.x2=r;const h=r/i.aspectRatio;t.y1=(a.offsetHeight-h)/2,t.y2=t.y1+h}else{t.y1=0,t.y2=s;const h=s*i.aspectRatio;t.x1=(a.offsetWidth-h)/2,t.x2=t.x1+h}else t.x1=0,t.x2=r,t.y1=0,t.y2=s}}move(e,t,i){const a=this.getClientX(e)-t.clientX,r=this.getClientY(e)-t.clientY;i.x1=t.x1+a,i.y1=t.y1+r,i.x2=t.x2+a,i.y2=t.y2+r}resize(e,t,i,a,r){const s=this.getClientX(e)-t.clientX,h=this.getClientY(e)-t.clientY;switch(t.position){case"left":i.x1=Math.min(Math.max(t.x1+s,i.x2-r.cropperScaledMaxWidth),i.x2-r.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(t.x1+s,i.x2-r.cropperScaledMaxWidth),i.x2-r.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+h,i.y2-r.cropperScaledMaxHeight),i.y2-r.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(t.y1+h,i.y2-r.cropperScaledMaxHeight),i.y2-r.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(t.x2+s,i.x1+r.cropperScaledMaxWidth),i.x1+r.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+h,i.y2-r.cropperScaledMaxHeight),i.y2-r.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(t.x2+s,i.x1+r.cropperScaledMaxWidth),i.x1+r.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(t.x2+s,i.x1+r.cropperScaledMaxWidth),i.x1+r.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+h,i.y1+r.cropperScaledMaxHeight),i.y1+r.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(t.y2+h,i.y1+r.cropperScaledMaxHeight),i.y1+r.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(t.x1+s,i.x2-r.cropperScaledMaxWidth),i.x2-r.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+h,i.y1+r.cropperScaledMaxHeight),i.y1+r.cropperScaledMinHeight);break;case"center":const l=e.scale,m=Math.min(Math.max(r.cropperScaledMinWidth,Math.abs(t.x2-t.x1)*l),r.cropperScaledMaxWidth),d=Math.min(Math.max(r.cropperScaledMinHeight,Math.abs(t.y2-t.y1)*l),r.cropperScaledMaxHeight);i.x1=t.clientX-m/2,i.x2=t.clientX+m/2,i.y1=t.clientY-d/2,i.y2=t.clientY+d/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>a.width&&(i.x1-=i.x2-a.width,i.x2=a.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>a.height&&(i.y1-=i.y2-a.height,i.y2=a.height)}r.maintainAspectRatio&&this.checkAspectRatio(t.position,i,a,r)}checkAspectRatio(e,t,i,a){let r=0,s=0;switch(e){case"top":t.x2=t.x1+(t.y2-t.y1)*a.aspectRatio,r=Math.max(t.x2-i.width,0),s=Math.max(0-t.y1,0),(r>0||s>0)&&(t.x2-=s*a.aspectRatio>r?s*a.aspectRatio:r,t.y1+=s*a.aspectRatio>r?s:r/a.aspectRatio);break;case"bottom":t.x2=t.x1+(t.y2-t.y1)*a.aspectRatio,r=Math.max(t.x2-i.width,0),s=Math.max(t.y2-i.height,0),(r>0||s>0)&&(t.x2-=s*a.aspectRatio>r?s*a.aspectRatio:r,t.y2-=s*a.aspectRatio>r?s:r/a.aspectRatio);break;case"topleft":t.y1=t.y2-(t.x2-t.x1)/a.aspectRatio,r=Math.max(0-t.x1,0),s=Math.max(0-t.y1,0),(r>0||s>0)&&(t.x1+=s*a.aspectRatio>r?s*a.aspectRatio:r,t.y1+=s*a.aspectRatio>r?s:r/a.aspectRatio);break;case"topright":t.y1=t.y2-(t.x2-t.x1)/a.aspectRatio,r=Math.max(t.x2-i.width,0),s=Math.max(0-t.y1,0),(r>0||s>0)&&(t.x2-=s*a.aspectRatio>r?s*a.aspectRatio:r,t.y1+=s*a.aspectRatio>r?s:r/a.aspectRatio);break;case"right":case"bottomright":t.y2=t.y1+(t.x2-t.x1)/a.aspectRatio,r=Math.max(t.x2-i.width,0),s=Math.max(t.y2-i.height,0),(r>0||s>0)&&(t.x2-=s*a.aspectRatio>r?s*a.aspectRatio:r,t.y2-=s*a.aspectRatio>r?s:r/a.aspectRatio);break;case"left":case"bottomleft":t.y2=t.y1+(t.x2-t.x1)/a.aspectRatio,r=Math.max(0-t.x1,0),s=Math.max(t.y2-i.height,0),(r>0||s>0)&&(t.x1+=s*a.aspectRatio>r?s*a.aspectRatio:r,t.y2-=s*a.aspectRatio>r?s:r/a.aspectRatio);break;case"center":t.x2=t.x1+(t.y2-t.y1)*a.aspectRatio,t.y2=t.y1+(t.x2-t.x1)/a.aspectRatio;const h=Math.max(0-t.x1,0),l=Math.max(t.x2-i.width,0),m=Math.max(t.y2-i.height,0),d=Math.max(0-t.y1,0);(h>0||l>0||m>0||d>0)&&(t.x1+=m*a.aspectRatio>h?m*a.aspectRatio:h,t.x2-=d*a.aspectRatio>l?d*a.aspectRatio:l,t.y1+=d*a.aspectRatio>l?d:l/a.aspectRatio,t.y2-=m*a.aspectRatio>h?m:h/a.aspectRatio)}}getClientX(e){return e.touches?.[0].clientX||e.clientX||0}getClientY(e){return e.touches?.[0].clientY||e.clientY||0}}return c.\u0275fac=function(e){return new(e||c)},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();let j=(()=>{class c{constructor(){this.autoRotateSupported=function N(){return new Promise(c=>{const p=new Image;p.onload=()=>{c(1===p.width&&2===p.height)},p.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(e,t){return new Promise((i,a)=>{const r=new FileReader;r.onload=s=>{this.loadImage(s.target.result,e.type,t).then(i).catch(a)},r.readAsDataURL(e)})}loadImage(e,t,i){return this.isValidImageType(t)?this.loadBase64Image(e,i):Promise.reject(new Error("Invalid image type"))}isValidImageType(e){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(e)}loadImageFromURL(e,t){return new Promise((i,a)=>{const r=new Image;r.onerror=()=>a,r.onload=()=>{const s=document.createElement("canvas"),h=s.getContext("2d");s.width=r.width,s.height=r.height,h?.drawImage(r,0,0),this.loadBase64Image(s.toDataURL(),t).then(i)},r.crossOrigin="anonymous",r.src=e})}loadBase64Image(e,t){return new Promise((i,a)=>{const r=new Image;r.onload=()=>i({originalImage:r,originalBase64:e}),r.onerror=a,r.src=e}).then(i=>this.transformImageBase64(i,t))}transformImageBase64(e,t){var i=this;return(0,u.Z)(function*(){const a=yield i.autoRotateSupported,r=yield function V(c){switch("string"==typeof c&&(c=function G(c){const p=new DataView(function X(c){c=c.replace(/^data\:([^\;]+)\;base64,/gim,"");const p=atob(c),e=p.length,t=new Uint8Array(e);for(let i=0;i<e;i++)t[i]=p.charCodeAt(i);return t.buffer}(c));if(65496!==p.getUint16(0,!1))return-2;const e=p.byteLength;let t=2;for(;t<e;){if(p.getUint16(t+2,!1)<=8)return-1;const i=p.getUint16(t,!1);if(t+=2,65505==i){if(1165519206!==p.getUint32(t+=2,!1))return-1;const a=18761==p.getUint16(t+=6,!1);t+=p.getUint32(t+4,a);const r=p.getUint16(t,a);t+=2;for(let s=0;s<r;s++)if(274==p.getUint16(t+12*s,a))return p.getUint16(t+12*s+8,a)}else{if(65280!=(65280&i))break;t+=p.getUint16(t,!1)}}return-1}(c)),c){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(a?-1:e.originalBase64);return e.originalImage&&e.originalImage.complete?i.transformLoadedImage({original:{base64:e.originalBase64,image:e.originalImage,size:{width:e.originalImage.naturalWidth,height:e.originalImage.naturalHeight}},exifTransform:r},t):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(e,t){var i=this;return(0,u.Z)(function*(){const a=t.canvasRotation+e.exifTransform.rotate,r={width:e.original.image.naturalWidth,height:e.original.image.naturalHeight};if(0===a&&!e.exifTransform.flip&&!t.containWithinAspectRatio)return{original:{base64:e.original.base64,image:e.original.image,size:{...r}},transformed:{base64:e.original.base64,image:e.original.image,size:{...r}},exifTransform:e.exifTransform};const s=i.getTransformedSize(r,e.exifTransform,t),h=document.createElement("canvas");h.width=s.width,h.height=s.height;const l=h.getContext("2d");l?.setTransform(e.exifTransform.flip?-1:1,0,0,1,h.width/2,h.height/2),l?.rotate(Math.PI*(a/2)),l?.drawImage(e.original.image,-r.width/2,-r.height/2);const m=h.toDataURL(),d=yield i.loadImageFromBase64(m);return{original:{base64:e.original.base64,image:e.original.image,size:{...r}},transformed:{base64:m,image:d,size:{width:d.width,height:d.height}},exifTransform:e.exifTransform}})()}loadImageFromBase64(e){return new Promise((t,i)=>{const a=new Image;a.onload=()=>t(a),a.onerror=i,a.src=e})}getTransformedSize(e,t,i){const a=i.canvasRotation+t.rotate;if(i.containWithinAspectRatio){if(a%2){const s=e.height/i.aspectRatio;return{width:Math.max(e.height,e.width*i.aspectRatio),height:Math.max(e.width,s)}}{const s=e.width/i.aspectRatio;return{width:Math.max(e.width,e.height*i.aspectRatio),height:Math.max(e.height,s)}}}return a%2?{height:e.width,width:e.height}:{width:e.width,height:e.height}}}return c.\u0275fac=function(e){return new(e||c)},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),J=(()=>{class c{constructor(e,t,i,a,r){this.cropService=e,this.cropperPositionService=t,this.loadImageService=i,this.sanitizer=a,this.cd=r,this.Hammer=window?.Hammer||null,this.settings=new O,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=C,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new n.vpe,this.startCropImage=new n.vpe,this.imageLoaded=new n.vpe,this.cropperReady=new n.vpe,this.loadImageFailed=new n.vpe,this.reset()}ngOnChanges(e){this.onChangesUpdateSettings(e),this.onChangesInputImage(e),this.loadedImage?.original.image.complete&&(e.containWithinAspectRatio||e.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t)),(e.cropper||e.maintainAspectRatio||e.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(e.maintainAspectRatio||e.aspectRatio)?this.resetCropperPosition():e.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),e.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}onChangesUpdateSettings(e){this.settings.setOptionsFromChanges(e),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(e){(e.imageChangedEvent||e.imageURL||e.imageBase64||e.imageFile)&&this.reset(),e.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),e.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),e.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),e.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+`deg)translate(${this.transform.translateH||0}%, ${this.transform.translateV||0}%)`)}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(e){this.loadImageService.loadImageFile(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(e){this.loadImageService.loadBase64Image(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(e){this.loadImageService.loadImageFromURL(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(e){this.loadedImage=e,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e.transformed.base64),this.cd.markForCheck()}loadImageError(e){console.error(e),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){this.loadedImage&&(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}activatePinchGesture(){if(this.Hammer){const e=new this.Hammer(this.wrapper.nativeElement);e.get("pinch").set({enable:!0}),e.on("pinchmove",this.onPinch.bind(this)),e.on("pinchend",this.pinchStop.bind(this)),e.on("pinchstart",this.startPinch.bind(this))}else(0,n.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const e=this.sourceImage.nativeElement;(this.maxSize.width!==e.offsetWidth||this.maxSize.height!==e.offsetHeight)&&(this.cropper.x1=this.cropper.x1*e.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*e.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*e.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*e.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(e){this.changeKeyboardStepSize(e),this.keyboardMoveCropper(e)}changeKeyboardStepSize(e){const t=+e.key;t>=1&&t<=9&&(this.settings.stepSize=t)}keyboardMoveCropper(e){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key))return;const i=e.shiftKey?C.Resize:C.Move,a=e.altKey?function Q(c){switch(c){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(e.key):function Z(c){switch(c){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(e.key),r=function L(c,p){switch(c){case"ArrowUp":return{clientX:0,clientY:-1*p};case"ArrowRight":return{clientX:p,clientY:0};case"ArrowDown":return{clientX:0,clientY:p};default:return{clientX:-1*p,clientY:0}}}(e.key,this.settings.stepSize);e.preventDefault(),e.stopPropagation(),this.startMove({clientX:0,clientY:0},i,a),this.moveImg(r),this.moveStop()}startMove(e,t,i=null){this.moveStart?.active&&this.moveStart?.type===C.Pinch||(e.preventDefault&&e.preventDefault(),this.moveStart={active:!0,type:t,position:i,clientX:this.cropperPositionService.getClientX(e),clientY:this.cropperPositionService.getClientY(e),...this.cropper})}startPinch(e){this.safeImgDataUrl&&(e.preventDefault&&e.preventDefault(),this.moveStart={active:!0,type:C.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}moveImg(e){this.moveStart.active&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===C.Move?(this.cropperPositionService.move(e,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===C.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}onPinch(e){this.moveStart.active&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===C.Pinch&&(this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const e=this.sourceImage.nativeElement;this.maxSize.width=e.offsetWidth,this.maxSize.height=e.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){const e=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/e:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/e:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(e=!1){this.cropper.x1<0&&(this.cropper.x2-=e?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=e?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=e?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=e?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(null!=this.loadedImage?.transformed?.image){this.startCropImage.emit();const e=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=e&&this.imageCropped.emit(e),e}return null}}return c.\u0275fac=function(e){return new(e||c)(n.Y36(F),n.Y36(P),n.Y36(j),n.Y36(w.H7),n.Y36(n.sBO))},c.\u0275cmp=n.Xpm({type:c,selectors:[["image-cropper"]],viewQuery:function(e,t){if(1&e&&(n.Gf(y,7),n.Gf(_,5)),2&e){let i;n.iGM(i=n.CRH())&&(t.wrapper=i.first),n.iGM(i=n.CRH())&&(t.sourceImage=i.first)}},hostVars:4,hostBindings:function(e,t){1&e&&n.NdJ("resize",function(){return t.onResize()},!1,n.Jf7)("mousemove",function(a){return t.moveImg(a)},!1,n.evT)("touchmove",function(a){return t.moveImg(a)},!1,n.evT)("mouseup",function(){return t.moveStop()},!1,n.evT)("touchend",function(){return t.moveStop()},!1,n.evT),2&e&&(n.Udp("text-align",t.alignImage),n.ekj("disabled",t.disabled))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[n.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(e,t){1&e&&(n.TgZ(0,"div",null,0),n.YNc(2,f,2,5,"img",1),n._UZ(3,"div",2),n.YNc(4,v,3,15,"div",3),n.qZA()),2&e&&(n.Udp("background",t.imageVisible&&t.backgroundColor),n.xp6(2),n.Q6J("ngIf",t.safeImgDataUrl),n.xp6(1),n.Udp("width",t.maxSize.width,"px")("height",t.maxSize.height,"px")("margin-left","center"===t.alignImage?t.marginLeft:null),n.xp6(1),n.Q6J("ngIf",t.imageVisible))},dependencies:[o.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),c})(),q=(()=>{class c{}return c.\u0275fac=function(e){return new(e||c)},c.\u0275mod=n.oAB({type:c}),c.\u0275inj=n.cJS({imports:[[o.ez]]}),c})()}}]);